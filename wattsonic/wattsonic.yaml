modbus:  
  - name: wattsonic 
    # type: tcp
    # host: 192.168.11.142
    # port: 502
    type: serial
    baudrate: 9600
    bytesize: 8
    method: rtu
    parity: N
    port: /dev/ttyUSB1
    stopbits: 1 
    sensors:
      - name: Wattsonic Inverter SN
        unique_id: wattsonic_inverter_sn
        slave: 247
        address: 10000
        input_type: holding
        count: 10
        data_type: string
        scan_interval: 86400
        lazy_error_count: 10
      - name: Wattsonic Inverter Running Status #0:wait, wait for on-grid 1:check, self-check 2:On Grid 3:fault 4:flash, firmware update 5.Off Grid
        unique_id: wattsonic_inverter_running_status
        slave: 247
        address: 10105
        input_type: holding
        count: 1
        data_type: int16
        scan_interval: 10
        lazy_error_count: 10
      - name: Wattsonic Phase A Power on Meter
        unique_id: wattsonic_phase_a_power_on_meter
        slave: 247
        address: 10994
        input_type: holding
        state_class: measurement
        unit_of_measurement: kW
        device_class: power
        count: 2
        scale: 0.001
        precision: 3
        data_type: int32
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Phase B Power on Meter
        unique_id: wattsonic_phase_b_power_on_meter
        slave: 247
        address: 10996
        input_type: holding
        state_class: measurement
        unit_of_measurement: kW
        device_class: power
        count: 2
        scale: 0.001
        precision: 3
        data_type: int32
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Phase C Power on Meter
        unique_id: wattsonic_phase_c_power_on_meter
        slave: 247
        address: 10998
        input_type: holding
        state_class: measurement
        unit_of_measurement: kW
        device_class: power
        count: 2
        scale: 0.001
        precision: 3
        data_type: int32
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Total Power on Meter        #Grid power
        unique_id: wattsonic_total_power_on_meter
        slave: 247
        address: 11000
        input_type: holding
        state_class: measurement
        unit_of_measurement: kW
        device_class: power
        count: 2
        scale: 0.001
        precision: 3
        data_type: int32
        scan_interval: 10
        lazy_error_count: 10

      - name: Wattsonic Grid Injection Energy on that day
        unique_id: wattsonic_grid_injection_energy_on_that_day
        slave: 247
        address: 31000
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing #measurement
        device_class: energy
        count: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic Grid Purchasing Energy on that day
        unique_id: wattsonic_grid_purchasing_energy_on_that_day
        slave: 247
        address: 31001
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing #measurement
        device_class: energy
        count: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic Backup Output Energy on that day
        unique_id: wattsonic_backup_output_energy_on_that_day
        slave: 247
        address: 31002
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing #measurement
        device_class: energy
        count: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic Battery Charge Energy on that day
        unique_id: wattsonic_battery_charge_energy_on_that_day
        slave: 247
        address: 31003
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing #measurement
        device_class: energy
        count: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic Battery Discharge Energy on that day
        unique_id: wattsonic_battery_discharge_energy_on_that_day
        slave: 247
        address: 31004
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing #measurement
        device_class: energy
        count: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic PV Generation Energy on that day    #E-today from GUI
        unique_id: wattsonic_pv_generation_energy_on_that_day
        slave: 247
        address: 31005
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing #measurement
        device_class: energy
        count: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic Loading Energy on that day
        unique_id: wattsonic_loading_energy_on_that_day
        slave: 247
        address: 31006
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing #measurement
        device_class: energy
        count: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic Energy Purchased from Grid on that day
        unique_id: wattsonic_energy_purchased_from_grid_on_that_day
        slave: 247
        address: 31008
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing #measurement
        device_class: energy
        count: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic Total Energy injected to grid
        unique_id: wattsonic_total_energy_injected_to_grid
        slave: 247
        address: 31102
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing
        device_class: energy
        count: 2
        data_type: int32
        scan_interval: 600
        lazy_error_count: 10
      - name: Wattsonic Total Energy Purchased from Grid from Meter
        unique_id: wattsonic_total_energy_purchased_from_grid_from_meter
        slave: 247
        address: 31104
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing
        device_class: energy
        count: 2
        data_type: int32
        scan_interval: 600
        lazy_error_count: 10
      - name: Wattsonic Total Output Energy on backup port
        unique_id: wattsonic_total_output_energy_on_backup_port
        slave: 247
        address: 31106
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing
        device_class: energy
        count: 2
        data_type: int32
        scan_interval: 3600
        lazy_error_count: 10
      - name: Wattsonic Total Energy Charged to Battery
        unique_id: wattsonic_total_energy_charged_to_battery
        slave: 247
        address: 31108
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing
        device_class: energy
        count: 2
        data_type: int32
        scan_interval: 600
        lazy_error_count: 10
      - name: Wattsonic Total Energy Discharged from Battery
        unique_id: wattsonic_total_energy_discharged_from_battery
        slave: 247
        address: 31110
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing
        device_class: energy
        count: 2
        data_type: int32
        scan_interval: 600
        lazy_error_count: 10
      - name: Wattsonic Total PV Generation
        unique_id: wattsonic_total_pv_generation
        slave: 247
        address: 31112
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing
        device_class: energy
        count: 2
        data_type: int32
        scan_interval: 600
        lazy_error_count: 10
      - name: Wattsonic Total Loading Energy consumed at grid side
        unique_id: wattsonic_total_loading_energy_consumed_at_grid_side
        slave: 247
        address: 31114
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing
        device_class: energy
        count: 2
        data_type: int32
        scan_interval: 3600
        lazy_error_count: 10
      - name: Wattsonic Total Energy Purchased from Grid at inverter side
        unique_id: wattsonic_total_energy_purchased_from_grid_at_inverter_side
        slave: 247
        address: 31118
        scale: 0.1
        precision: 1
        input_type: holding
        unit_of_measurement: kWh
        state_class: total_increasing
        device_class: energy
        count: 2
        data_type: int32
        scan_interval: 3600
        lazy_error_count: 10

      - name: Wattsonic Total Grid-Injection Energy on Meter
        unique_id: wattsonic_total_grid_injection_energy_on_meter
        slave: 247
        address: 11002
        input_type: holding
        state_class: total_increasing
        unit_of_measurement: kWh
        device_class: energy
        count: 2
        scale: 0.01
        precision: 2
        data_type: int32
        scan_interval: 3600
        lazy_error_count: 10
      - name: Wattsonic Total Purchasing Energy from Grid on Meter
        unique_id: wattsonic_total_purchasing_energy_from_grid_on_meter
        slave: 247
        address: 11004
        input_type: holding
        state_class: total_increasing
        unit_of_measurement: kWh
        device_class: energy
        count: 2
        scale: 0.01
        precision: 2
        data_type: int32
        scan_interval: 3600
        lazy_error_count: 10

      - name: Wattsonic Grid Lines A/B Voltage
        unique_id: wattsonic_grid_lines_a_b_voltage
        slave: 247
        address: 11006
        input_type: holding
        unit_of_measurement: V
        state_class: measurement
        device_class: voltage
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Grid Lines B/C Voltage
        unique_id: wattsonic_grid_lines_b_c_voltage
        slave: 247
        address: 11007
        input_type: holding
        unit_of_measurement: V
        state_class: measurement
        device_class: voltage
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Grid Lines C/A Voltage
        unique_id: wattsonic_grid_lines_c_a_voltage
        slave: 247
        address: 11008
        input_type: holding
        unit_of_measurement: V
        state_class: measurement
        device_class: voltage
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16        
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Grid Phase A Voltage
        unique_id: wattsonic_grid_phase_a_voltage
        slave: 247
        address: 11009
        input_type: holding
        unit_of_measurement: V
        state_class: measurement
        device_class: voltage
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Grid Phase B Voltage
        unique_id: wattsonic_grid_phase_b_voltage
        slave: 247
        address: 11011
        input_type: holding
        unit_of_measurement: V
        state_class: measurement
        device_class: voltage
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Grid Phase C Voltage
        unique_id: wattsonic_grid_pase_c_voltage
        slave: 247
        address: 11013
        input_type: holding
        unit_of_measurement: V
        state_class: measurement
        device_class: voltage
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Grid Phase A Current
        unique_id: wattsonic_grid_phase_a_current
        slave: 247
        address: 11010
        input_type: holding
        state_class: measurement
        unit_of_measurement: A
        device_class: current
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Grid Phase B Current
        unique_id: wattsonic_grid_phase_b_current
        slave: 247
        address: 11012
        input_type: holding
        state_class: measurement
        unit_of_measurement: A
        device_class: current
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Grid Phase C Current
        unique_id: wattsonic_grid_phase_c_current
        slave: 247
        address: 11014
        input_type: holding
        state_class: measurement
        unit_of_measurement: A
        device_class: current
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic P AC
        unique_id: wattsonic_p_ac
        slave: 247
        address: 11016
        input_type: holding
        state_class: measurement
        unit_of_measurement: kW
        device_class: power
        count: 2
        scale: 0.001
        precision: 3
        data_type: int32
        scan_interval: 10
        lazy_error_count: 10
      - name: Wattsonic Total PV Generation on that day
        unique_id: wattsonic_total_pv_generation_on_that_day
        slave: 247
        address: 11018
        input_type: holding
        state_class: total_increasing #measurement
        device_class: energy
        unit_of_measurement: kWh
        count: 2
        scale: 0.1
        precision: 1
        data_type: int32
        scan_interval: 1800
        lazy_error_count: 10
      - name: Wattsonic Total PV Generation from Installation
        unique_id: wattsonic_total_pv_generation_from_installation
        slave: 247
        address: 11020
        input_type: holding
        state_class: total_increasing #measurement
        device_class: energy
        unit_of_measurement: kWh
        count: 2
        scale: 0.1
        precision: 1
        data_type: int32
        scan_interval: 3600
        lazy_error_count: 10
      - name: Wattsonic PV Input Total Power        #PV power, panel actual power
        unique_id: wattsonic_pv_input_total_power
        slave: 247
        address: 11028
        input_type: holding
        state_class: measurement
        device_class: power
        unit_of_measurement: kW
        count: 2
        scale: 0.001
        precision: 3
        data_type: int32
        scan_interval: 10
        lazy_error_count: 10
      - name: Wattsonic Temperature Sensor 1
        unique_id: wattsonic_temperature_sensor_1
        slave: 247
        address: 11032
        input_type: holding
        state_class: measurement
        unit_of_measurement: °C
        device_class: temperature
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 600
        lazy_error_count: 10
      - name: Wattsonic Temperature Sensor 2
        unique_id: wattsonic_temperature_sensor_2
        slave: 247
        address: 11033
        input_type: holding
        state_class: measurement
        unit_of_measurement: °C
        device_class: temperature
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 600
        lazy_error_count: 10
      - name: Wattsonic Temperature Sensor 3
        unique_id: wattsonic_temperature_sensor_3
        slave: 247
        address: 11034
        input_type: holding
        state_class: measurement
        unit_of_measurement: °C
        device_class: temperature
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 600
        lazy_error_count: 10
      - name: Wattsonic Temperature Sensor 4
        unique_id: wattsonic_temperature_sensor_4
        slave: 247
        address: 11035
        input_type: holding
        state_class: measurement
        unit_of_measurement: °C
        device_class: temperature
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 600
        lazy_error_count: 10
      - name: Wattsonic PV1 Voltage
        unique_id: wattsonic_pv1_voltage
        slave: 247
        address: 11038
        input_type: holding
        unit_of_measurement: V
        state_class: measurement
        device_class: voltage
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic PV2 Voltage
        unique_id: wattsonic_pv2_voltage
        slave: 247
        address: 11040
        input_type: holding
        unit_of_measurement: V
        state_class: measurement
        device_class: voltage
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic PV1 Current
        unique_id: wattsonic_pv1_current
        slave: 247
        address: 11039
        input_type: holding
        state_class: measurement
        unit_of_measurement: A
        device_class: current
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic PV2 Current
        unique_id: wattsonic_pv2_current
        slave: 247
        address: 11041
        input_type: holding
        state_class: measurement
        unit_of_measurement: A
        device_class: current
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic PV1 Input Power
        unique_id: wattsonic_pv1_input_power
        slave: 247
        address: 11062
        input_type: holding
        state_class: measurement
        unit_of_measurement: kW
        device_class: power
        count: 2
        scale: 0.001
        precision: 3
        data_type: int32
        scan_interval: 10
        lazy_error_count: 10
      - name: Wattsonic PV2 Input Power
        unique_id: wattsonic_pv2_input_power
        slave: 247
        address: 11064
        input_type: holding
        state_class: measurement
        unit_of_measurement: kW
        device_class: power
        count: 2
        scale: 0.001
        precision: 3
        data_type: int32
        scan_interval: 10
        lazy_error_count: 10
      - name: Wattsonic Total Backup P          #load power
        unique_id: wattsonic_total_backup_p
        slave: 247
        address: 30230
        input_type: holding
        state_class: measurement
        unit_of_measurement: kW
        device_class: power
        count: 2
        scale: 0.001
        precision: 3
        data_type: int32
        scan_interval: 10
        lazy_error_count: 10

      - name: Wattsonic Battery V #DC Voltage
        unique_id: wattsonic_battery_v
        slave: 247
        address: 30254
        input_type: holding
        unit_of_measurement: V
        state_class: measurement
        device_class: voltage
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic Battery I #DC Current
        unique_id: wattsonic_battery_i
        slave: 247
        address: 30255
        input_type: holding
        state_class: measurement
        unit_of_measurement: A
        device_class: current
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic Battery P           #Battery Power
        unique_id: wattsonic_battery_p
        slave: 247
        address: 30258
        input_type: holding
        state_class: measurement
        unit_of_measurement: kW
        device_class: power
        count: 2
        scale: 0.001
        precision: 3
        data_type: int32
        scan_interval: 10
        lazy_error_count: 10
      - name: Wattsonic Battery Mode #0:discharge;1:charge
        unique_id: wattsonic_battery_mode
        slave: 247
        address: 30256
        input_type: holding
        count: 1
        data_type: int16
        scan_interval: 10
        lazy_error_count: 10
      - name: Wattsonic BMS Pack Temperature
        unique_id: wattsonic_bms_pack_temperature
        slave: 247
        address: 33003
        input_type: holding
        state_class: measurement
        unit_of_measurement: °C
        device_class: temperature
        count: 1
        scale: 0.1
        precision: 1
        data_type: int16
        scan_interval: 300
        lazy_error_count: 10
      - name: Wattsonic Battery SOC
        unique_id: wattsonic_battery_soc
        slave: 247
        address: 33000
        input_type: holding
        state_class: measurement
        #unit_of_measurement: '%'
        device_class: battery
        count: 1
        scale: 0.01
        precision: 2
        data_type: int16
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Battery SOH
        unique_id: wattsonic_battery_soh
        slave: 247
        address: 33001
        input_type: holding
        state_class: measurement
        #unit_of_measurement: '%'
        device_class: battery
        count: 1
        scale: 0.01
        precision: 2
        data_type: int16
        scan_interval: 3600
        lazy_error_count: 10

#RW values
      - name: Wattsonic Hybrid Inverter Working Mode Setting  #257=General mode; 258=Economic mode; 259=UPS mode; asi 512=Off grid mode
        unique_id: wattsonic_hybrid_inverter_working_mode_setting #RW
        slave: 247
        address: 50000
        input_type: holding
        count: 1
        data_type: int16
        scan_interval: 60
        lazy_error_count: 10
      - name: Wattsonic Grid Injection Power Limit Switch  #0:Off;1:ON
        unique_id: wattsonic_grid_injection_power_limit_switch #RW
        slave: 247
        address: 25100
        input_type: holding
        count: 1
        data_type: int16
        scan_interval: 360
        lazy_error_count: 10
      - name: Wattsonic Grid Injection Power Limit Setting  #[0.0%-100.0%]
        unique_id: wattsonic_grid_injection_power_limit_setting #RW
        slave: 247
        address: 25103
        input_type: holding
        count: 1
        scale: 0.1    #spec: 1000
        precision: 1
        data_type: int16
        scan_interval: 360
        lazy_error_count: 10
      - name: Wattsonic Priority Power Output Setting  #0：PV Output Priority ; 1：Battery Output Priority
        unique_id: wattsonic_priority_power_output_setting #RW
        slave: 247
        address: 50210
        input_type: holding
        count: 1
        data_type: int16
        scan_interval: 360
        lazy_error_count: 10
      - name: Wattsonic On-grid Battery End SOC  #[0.0%-100.0%]
        unique_id: wattsonic_on_grid_battery_end_soc #RW
        slave: 247
        address: 52503
        input_type: holding
        count: 1
        scale: 0.1    #spec: 1000
        precision: 1
        data_type: int16
        scan_interval: 360
        lazy_error_count: 10
      - name: Wattsonic Off-grid Battery End SOC  #[0.0%-100.0%]
        unique_id: wattsonic_off_grid_battery_end_soc #RW
        slave: 247
        address: 52505
        input_type: holding
        count: 1
        scale: 0.1    #spec: 1000
        precision: 1
        data_type: int16
        scan_interval: 360
        lazy_error_count: 10
      - name: Wattsonic On-grid Battery SOC Protection Switch  #0:Off;1:ON
        unique_id: wattsonic_on_grid_battery_soc_protection_switch #RW
        slave: 247
        address: 52502
        input_type: holding
        count: 1
        data_type: int16
        scan_interval: 360
        lazy_error_count: 10
      - name: Wattsonic Off-grid Battery SOC Protection Switch  #0:Off;1:ON
        unique_id: wattsonic_off_grid_battery_soc_protection_switch #RW
        slave: 247
        address: 52504
        input_type: holding
        count: 1
        data_type: int16
        scan_interval: 360
        lazy_error_count: 10



sensor:
  - platform: template
    sensors:
      wattsonic_battery_mode_text:
         friendly_name: Wattsonic Battery Mode
         value_template: >
            {% if states('sensor.wattsonic_battery_mode') == '0' %}
                discharge
            {% else %}
                charge
            {% endif %}
      wattsonic_hybrid_inverter_working_mode_setting_text:
         friendly_name: Wattsonic Hybrid Inverter Working Mode
         value_template: >
            {% if states('sensor.wattsonic_hybrid_inverter_working_mode_setting') == '257' %}
                General mode
            {% elif states('sensor.wattsonic_hybrid_inverter_working_mode_setting') == '258' %}
                Economic mode
            {% elif states('sensor.wattsonic_hybrid_inverter_working_mode_setting') == '259' %}
                UPS mode
            {% elif states('sensor.wattsonic_hybrid_inverter_working_mode_setting') == '512' %}
                Offgrid mode
            {% endif %}
      wattsonic_inverter_running_status_text:
         friendly_name: Wattsonic Inverter Running Status
         value_template: >
            {% if states('sensor.wattsonic_inverter_running_status') == '0' %}
                wait
            {% elif states('sensor.wattsonic_inverter_running_status') == '1' %}
                check
            {% elif states('sensor.wattsonic_inverter_running_status') == '2' %}
                On Grid
            {% elif states('sensor.wattsonic_inverter_running_status') == '3' %}
                fault
            {% elif states('sensor.wattsonic_inverter_running_status') == '4' %}
                flash
            {% elif states('sensor.wattsonic_inverter_running_status') == '5' %}
                Off Grid
            {% endif %}
